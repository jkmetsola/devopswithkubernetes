---
{{- with .Values}}
{{- template "deployment.spec.base" $}}
    spec:
      containers:
          {{- template "container.base" $}}
          envFrom:
            - secretRef:
                name: {{index .apps.postgres.containerNames 0}}
          ports:
            - containerPort: {{.appPort}}
          {{- template "probes.get" $}}
          {{- template "security.context" $}}
          {{- template "volumemounts.base" $}}
            - name: {{.sharedPersistentVolumeName}}
              mountPath: {{.sharedVolumeMountPath}}
      {{- template "volumes.base" $}}
        - name: {{.sharedPersistentVolumeName}}
          persistentVolumeClaim:
            claimName: {{.sharedPersistentVolumeClaimName}}
      terminationGracePeriodSeconds: 5
{{- end}}
